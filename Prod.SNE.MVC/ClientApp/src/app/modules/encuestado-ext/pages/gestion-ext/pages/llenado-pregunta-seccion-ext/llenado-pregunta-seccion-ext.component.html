
<ng-container *ngIf="show_pregunta_llenado">
    <div class="_container">
        <div class="row">
            <div class="col-sm-1"></div>
            <div class="col-sm-10">
                <div class="row" *ngIf="total>0">
                    <div class="col-sm-12" style="padding-top:10px; padding-bottom:10px" *ngIf="!loaded_pagination" align="center">
                        <span style="color:#cf2a27;font-size:25px">
                            <nz-spin nzSimple></nz-spin>
                        </span>
                    </div>
                    <div class="col-sm-12" style="padding-top:10px; padding-bottom:10px" *ngIf="loaded_pagination" align="center">
                        <div class="row">
                            <div class="col-md-12" style="padding-top: 50px;">
                                <span *ngFor="let item of arraySecciones" style="padding-right: 10px;">
                                    <span style="font-size: 20px;" class="text-seccion-activo" *ngIf="item.actual">{{item.seccion}} {{item.orden}} <img style="margin-top: -3px;" src="assets/img/seccion.png"></span>
                                    <span style="font-size: 20px;" class="text-seccion-inactivo" *ngIf="!item.actual">{{item.orden}}</span>         
                                </span>
                            </div>
                            <div class="col-md-12" style="padding-top: 20px;">
                                <span *ngFor="let item of arraySeccionActivo.preguntas" style="padding-right: 10px;">
                                    <img *ngIf="item.resuelto && !item.actual" src="assets/img/contestado.png" >
                                    <img *ngIf="item.actual && !item.resuelto" src="assets/img/actual.png" >
                                    <img *ngIf="!item.resuelto && !item.actual" src="assets/img/sin_contestar.png">
                                </span>
                            </div>
                            <!-- <nz-radio-group [(ngModel)]="pageIndex" nzButtonStyle="solid" (ngModelChange)="onPageChange($event)">
                                <label *ngFor="let page of getPaginationNotHidden(); let idx=index;"  
                                nz-radio-button
                                [ngClass]="{'btn_marked': page.resolved}"
                                [nzValue]="page.page" >{{page.page}}</label>
                            </nz-radio-group> -->
                        </div>
                    </div>
                    <div class="row" *ngIf="total>0 && JSON_PREGUNTA!=null" >
                        <div [ngClass]="tieneArchivo ? 'col-md-7': 'col-md-12'" style="padding-top: 50px;">
                            <div class="row">
                                <div class="col-md-12">
                                    <span class="text-pregunta">Pregunta</span>&nbsp;&nbsp;&nbsp;&nbsp;
                                    <img (click)="start_speech()" src="assets/img/audio.png">&nbsp;&nbsp;&nbsp;
                                    <span *ngIf="JSON_PREGUNTA.es_obligatorio" class="text-obligatorio">*Obligatorio</span>
                                </div>
                                <div class="col-md-12" style="padding-top: 20px;">
                                    <span style="font-size: 20px;" class="text-titulo">{{Pregunta.pregunta}}</span>
                                </div>
                                <div class="col-md-12" style="padding-top: 5px;">
                                    <span style="font-size: 15px;" class="text-descripcion">{{Pregunta.descripcion}}</span>
                                </div>
                            </div>
                            <div class="col-md-12" style="padding-top: 25px;padding-left: 0;" *ngIf="JSON_PREGUNTA.id_tipo==_TIPO_PREGUNTA.desplegable_institucional && JSON_PREGUNTA.tbl_data==2">
                                <div class="row">
                                    <div class="col-md-5 col-sm-6">
                                        <div style="background-color:#EAEFF5; height: 40px;">
                                            <label style="padding-top:9px">
                                                &nbsp;&nbsp;<strong>{{JSON_PREGUNTA.tbl_data==1?'Dependecia':'Regimen'}}</strong>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-7 col-sm-6">
                                        <div class="form-group">
                                            <nz-form-item>
                                                <nz-form-control nzErrorTip="Debe seleccionar una alternativa!">
                                                    <nz-input-group>
                                                        <nz-select nzAllowClear nzShowSearch 
                                                        [(ngModel)]="JSON_PREGUNTA.respuesta"
                                                        style="width: 304px !important;"
                                                        nzPlaceHolder="--Seleccione--">
                                                            <ng-container *ngFor="let item of array_regimen_cbo">
                                                                <nz-option [nzValue]="item.id" [nzLabel]="item.nombre"></nz-option>
                                                            </ng-container>
                                                        </nz-select>
                                                    </nz-input-group>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                       
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12" style="padding-top: 25px;padding-left: 0;" *ngIf="JSON_PREGUNTA.id_tipo==_TIPO_PREGUNTA.desplegable_institucional && JSON_PREGUNTA.tbl_data==1">
                                <div class="row">
                                    <div class="col-md-5 col-sm-6">
                                        <div style="background-color:#EAEFF5; height: 40px;">
                                            <label style="padding-top:9px">
                                                &nbsp;&nbsp;<strong>Órgano de alta dirección</strong>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-7 col-sm-6">
                                        <div class="form-group">
                                            <nz-form-item>
                                                <nz-form-control nzErrorTip="Debe seleccionar una alternativa!">
                                                    <nz-input-group>
                                                        <nz-select nzAllowClear 
                                                        [(ngModel)]="JSON_PREGUNTA.respuesta.d1"
                                                        (ngModelChange)="getD2($event)"
                                                        style="width: 304px !important;"
                                                        nzPlaceHolder="Opción 1">
                                                            <ng-container *ngFor="let item of d1">
                                                                <nz-option [nzValue]="item.id" [nzLabel]="item.nombre"></nz-option>
                                                            </ng-container>
                                                        </nz-select>
                                                    </nz-input-group>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                       
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-5 col-sm-6" style="padding-top: 15px;">
                                        <div style="background-color:#EAEFF5; height: 40px;">
                                            <label style="padding-top:9px">
                                                &nbsp;&nbsp;<strong>Dirección/Oficina General</strong>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-7 col-sm-6" style="padding-top: 15px;">
                                        <nz-form-item>
                                            <nz-form-control nzErrorTip="Debe seleccionar una alternativa!">
                                                <nz-input-group>
                                                    <nz-select nzAllowClear 
                                                    [(ngModel)]="JSON_PREGUNTA.respuesta.d2"
                                                    (ngModelChange)="getD3($event)"
                                                    [nzDisabled]="d2_disabled"
                                                    style="width: 304px !important;"
                                                    nzPlaceHolder="Opción 2">
                                                        <ng-container *ngFor="let item of d2">
                                                            <nz-option [nzValue]="item.id" [nzLabel]="item.nombre"></nz-option>
                                                        </ng-container>
                                                    </nz-select>
                                                </nz-input-group>
                                            </nz-form-control>
                                        </nz-form-item>
                                    </div>
                                </div>
    
                                <div class="row">
                                    <div class="col-md-5 col-sm-6" style="padding-top: 15px;">
                                        <div style="background-color:#EAEFF5; height: 40px;">
                                            <label style="padding-top:9px">
                                                &nbsp;&nbsp;<strong>Unidad Orgánica</strong>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-7 col-sm-6" style="padding-top: 15px;">
                                        <nz-form-item>
                                            <nz-form-control nzErrorTip="Debe seleccionar una alternativa!">
                                                <nz-input-group>
                                                    <nz-select nzAllowClear 
                                                    [(ngModel)]="JSON_PREGUNTA.respuesta.d3"
                                                    [nzDisabled]="d3_disabled"
                                                    style="width: 304px !important;"
                                                    nzPlaceHolder="Opción 3">
                                                        <ng-container *ngFor="let item of d3">
                                                            <nz-option [nzValue]="item.id" [nzLabel]="item.nombre"></nz-option>
                                                        </ng-container>
                                                    </nz-select>
                                                </nz-input-group>
                                            </nz-form-control>
                                        </nz-form-item>
                                    </div>
                                </div>
                            </div> 
                            <div class="col-md-12" style="padding-top: 25px;padding-left: 0;" *ngIf="JSON_PREGUNTA.id_tipo==_TIPO_PREGUNTA.desplegable_libre">
                                <nz-form-item>
                                    <nz-form-control nzErrorTip="Debe seleccionar una alternativa!">
                                        <nz-input-group>
                                            <nz-select nzAllowClear nzShowSearch 
                                            [(ngModel)]="JSON_PREGUNTA.respuesta[0]"
                                            style="width: 304px !important;"
                                            nzPlaceHolder="--Seleccione--">
                                                <ng-container *ngFor="let item of JSON_PREGUNTA.opciones">
                                                    <nz-option [nzValue]="item.idx" [nzLabel]="item.descripcion"></nz-option>
                                                </ng-container>
                                            </nz-select>
                                        </nz-input-group>
                                    </nz-form-control>
                                </nz-form-item>
                            </div> 
                            <div class="col-md-12"  style="padding-top: 25px;padding-left: 0;" *ngIf="JSON_PREGUNTA.id_tipo==_TIPO_PREGUNTA.numerico_entero" >
                                <nz-form-item>
                                    <nz-form-control nzErrorTip="Debe seleccionar una alternativa!" style="width:100%">
                                        <nz-input-group>
                                            <input type="text" style="width: 304px !important;"
                                            [(ngModel)]="JSON_PREGUNTA.respuesta" 
                                            (keypress)="conteoDigitosEntero($event, JSON_PREGUNTA)"
                                            nz-input nzPlaceHolder="--Valor numérico decimal--" >
                                        </nz-input-group>
                                    </nz-form-control>
                                </nz-form-item>   
                            </div>  
                            <div class="col-md-12" style="padding-top: 25px;padding-left: 0;" *ngIf="JSON_PREGUNTA.id_tipo==_TIPO_PREGUNTA.numerico_decimal" >
                                
                                    <nz-form-item style="width:100%">
                                        <nz-form-control nzErrorTip="Debe seleccionar un número!" style="width:100%">
                                            <nz-input-group style="width:100%">
                                                <input 
                                                type="text" 
                                                style="width:304px !important;"
                                                [(ngModel)]="JSON_PREGUNTA.respuesta" 
                                                (keypress)="conteoDigitosDecimal($event, JSON_PREGUNTA)"
                                                >
                                            </nz-input-group>
                                        </nz-form-control>
                                    </nz-form-item>                                
                            </div> 
                            <div class="col-md-12" style="padding-top: 25px;padding-left: 0;" *ngIf="JSON_PREGUNTA.id_tipo==_TIPO_PREGUNTA.seleccion_unica">
                               
                                    <div class="radio" *ngFor="let item of JSON_PREGUNTA.opciones; let idx=index">
                                        <label class="label-radio">
                                          <input 
                                            (click)="setOneClickedOnly(idx, item.idx)" 
                                            [class]="JSON_PREGUNTA.respuesta[item.idx].selected?'_btn btn-primary-custom':'_btn btn-white'"
                                            [checked]="JSON_PREGUNTA.respuesta[item.idx].selected"
                                            type="radio" 
                                            name="optionsRadios" 
                                            id="optionsRadios1">
                                          {{item.descripcion}}
                                        </label>
                                    </div>   
                                    <div class="form-group" *ngIf="esAgregarPreguntaMultiple">
                                        <nz-form-item>
                                            <nz-form-control>
                                                <nz-input-group>
                                                    <textarea nz-input class="form-control" 
                                                    maxlength="20"
                                                    [(ngModel)]="JSON_PREGUNTA.otro"  placeholder="Otro"></textarea>
                                                </nz-input-group>
                                            </nz-form-control>
                                        </nz-form-item>  
                                        <span class="text-caracteres">max 20 caracteres</span>  
                                    </div> 
                            </div>
                            <div class="col-md-12" style="padding-top: 25px;padding-left: 0;" *ngIf="JSON_PREGUNTA.id_tipo==_TIPO_PREGUNTA.seleccion_multiple">
                                <div class="checkbox" *ngFor="let item of JSON_PREGUNTA.opciones; let idx=index">
                                    <label class="label-checkbox">
                                      <input 
                                      type="checkbox" 
                                      [class]="JSON_PREGUNTA.respuesta[item.idx].selected?'_btn btn-primary-custom':'_btn btn-white'"
                                      [checked]="JSON_PREGUNTA.respuesta[item.idx].selected"
                                      (click)="setOneClickedMultiple(idx, item.idx)">
                                      {{item.descripcion}}
                                    </label>
                                </div>
                                <div class="form-group" *ngIf="esAgregarPreguntaMultiple">
                                    <nz-form-item>
                                        <nz-form-control>
                                            <nz-input-group>
                                                <textarea nz-input class="form-control" 
                                                maxlength="20"
                                                [(ngModel)]="JSON_PREGUNTA.otro"  placeholder="Otro"></textarea>
                                            </nz-input-group>
                                        </nz-form-control>
                                    </nz-form-item>  
                                    <span class="text-caracteres">max 20 caracteres</span>  
                                </div>
                            </div>   
                            <div class="col-md-12" style="padding-top: 25px;padding-left: 0;"  *ngIf="JSON_PREGUNTA.id_tipo==_TIPO_PREGUNTA.matriz">
                                
                                <div class="table-responsive table-striped table-bordered table-hover" *ngIf="JSON_PREGUNTA.es_columna_matriz">
                                    <nz-table #basicTable 
                                    [nzData]="JSON_PREGUNTA.respuesta"
                                    [nzFrontPagination]="false"
                                    [nzShowPagination]="false"
                                    [nzLoading]="loading_matriz"
                                    class="container-table-custom">
                                        <thead>
                                            <tr>
                                                <th class="th-columna"></th>
                                                <th style="width:170px" class="th-columna" *ngFor="let col of JSON_PREGUNTA.columnas" align="center">{{col.nombre_columna}}</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr  *ngFor="let fila of basicTable.data">
                                                <td class="td-fila" style="width:170px" align="center">{{ fila.nombre_fila }}</td>
                                                <td *ngFor="let col of fila.columnas;" align="center">
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.numerico_entero">
                                                        <nz-form-item style="width:100%">
                                                            <nz-form-control nzErrorTip="Debe seleccionar un número!" style="width:100%">
                                                                <nz-input-group style="width:100%">
                                                                    <input 
                                                                    type="text" 
                                                                    style="width:170px"
                                                                    [formControl]="frmMtz[fila.idx][col.idx]"
                                                                    [(ngModel)]="fila.respuestas[col.idx]" 
                                                                    (ngModelChange)	="setRespuestaMatriz(fila.idx,col.idx)"
                                                                    (keypress)="conteoDigitosEnteroMatriz($event,fila.idx,col.idx)"
                                                                    >
                                                                </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>
                                                    </div>
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.numerico_decimal">
                                                        <nz-form-item style="width:100%">
                                                            <nz-form-control nzErrorTip="Debe seleccionar un número!" style="width:100%">
                                                                <nz-input-group style="width:100%">
                                                                    <input 
                                                                    type="text" 
                                                                    style="width:170px"
                                                                    [formControl]="frmMtz[fila.idx][col.idx]"
                                                                    [(ngModel)]="fila.respuestas[col.idx]" 
                                                                    (ngModelChange)="setRespuestaMatriz(fila.idx,col.idx)"
                                                                    (keypress)="conteoDigitosDecimalMatriz($event,fila.idx,col.idx)"
                                                                    >
                                                                </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>
                                                    </div>
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.seleccion_unica">
                                                        <nz-form-item>
                                                            <nz-form-control nzErrorTip="Debe seleccionar una alternativa!" style="width:100%">
                                                                <nz-input-group>
                                                                    <nz-select nzAllowClear nzShowSearch
                                                                    (ngModelChange)	="setRespuestaMatriz(fila.idx,col.idx,true)"
                                                                    [formControl]="frmMtz[fila.idx][col.idx]"
                                                                    [(ngModel)]="fila.respuestas[col.idx]" 
                                                                    style="max-width: 100% !important; min-width: 170px !important;"
                                                                    nzPlaceHolder="--Seleccione--">
                                                                        <ng-container *ngFor="let _item of col.forma.opciones">
                                                                            <nz-option [nzValue]="_item.descripcion" [nzLabel]="_item.descripcion"></nz-option>
                                                                        </ng-container>
                                                                    </nz-select>
                                                                </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>
                                                    </div>
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.seleccion_multiple ||
                                                    col.forma.id_tipo==_TIPO_PREGUNTA.desplegable_libre">
                                                        <nz-form-item>
                                                            <nz-form-control nzErrorTip="Debe seleccionar una alternativa!" style="width:100%">
                                                                <nz-input-group>
                                                                    <nz-select nzAllowClear nzShowSearch 
                                                                    [formControl]="frmMtz[fila.idx][col.idx]"
                                                                    [(ngModel)]="fila.respuestas[col.idx]" 
                                                                    (ngModelChange)	="setRespuestaMatriz(fila.idx,col.idx)"
                                                                    style="max-width: 100% !important; min-width: 170px !important;"
                                                                    nzMode="multiple"
                                                                    nzPlaceHolder="--Seleccione--">
                                                                        <ng-container *ngFor="let _item of col.forma.opciones">
                                                                            <nz-option [nzValue]="_item.descripcion" [nzLabel]="_item.descripcion"></nz-option>
                                                                        </ng-container>
                                                                    </nz-select>
                                                                </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>
                                                    </div>
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.desplegable_institucional && col.forma.tbl_data==2" class="row">
                                                        <nz-form-item>
                                                            <nz-form-control nzErrorTip="Debe seleccionar una alternativa!" style="width:100%">
                                                                <nz-input-group>
                                                                    <nz-select nzAllowClear nzShowSearch 
                                                                    [formControl]="frmMtz[fila.idx][col.idx]"
                                                                    [(ngModel)]="fila.respuestas[col.idx]" 
                                                                    (ngModelChange)	="setRespuestaMatriz(fila.idx,col.idx)"
                                                                    style="max-width: 100% !important; min-width: 170px !important;"
                                                                    nzPlaceHolder="--Seleccione--">
                                                                        <ng-container *ngFor="let item of array_regimen_cbo">
                                                                            <nz-option [nzValue]="item.id" [nzLabel]="item.nombre"></nz-option>
                                                                        </ng-container>
                                                                    </nz-select>
                                                                </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>
                                                    </div>
    
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.desplegable_institucional && col.forma.tbl_data==1" class="row">
                                                        <nz-form-item>
                                                            <nz-form-control nzErrorTip="Debe seleccionar una alternativa!" style="width:100%">
                                                                <nz-input-group>
                                                                    <nz-select nzAllowClear nzShowSearch 
                                                                    [formControl]="frmMtz[fila.idx][col.idx]"
                                                                    [(ngModel)]="fila.respuestas[col.idx]" 
                                                                    (ngModelChange)	="setRespuestaMatriz(fila.idx,col.idx)"
                                                                    style="max-width: 100% !important; min-width: 170px !important;"
                                                                    nzPlaceHolder="--Seleccione--">
                                                                        <ng-container *ngFor="let item of array_d_gen">
                                                                            <nz-option [nzValue]="item.id" [nzLabel]="item.nombre"></nz-option>
                                                                        </ng-container>
                                                                    </nz-select>
                                                                </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>
                                                    </div>
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.fecha">
                                                        <nz-form-item style="width:100%">
                                                            <nz-form-control nzErrorTip="Debe seleccionar una fecha!" style="width:100%">
                                                                <nz-input-group style="width:100%">
                                                                    <nz-date-picker 
                                                                        style="width:170px"
                                                                        [(ngModel)]="fila.respuestas[col.idx]" 
                                                                        nzFormat="{{ col.forma.formato }}"
                                                                        nzPlaceHolder="{{ col.forma.formato }}">
                                                                        </nz-date-picker>
                                                                    </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>
                                                    </div>
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.texto">
                                                        <nz-form-item>
                                                            <nz-form-control nzErrorTip="Debe ingresar un texto." style="width:100%">
                                                                <nz-input-group>
                                                                    <textarea nz-input class="form-control" 
                                                                    style="width:190px"
                                                                    maxlength="100"
                                                                    [(ngModel)]="fila.respuestas[col.idx]"  placeholder="Ingresar"></textarea>
                                                                </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>   
                                                    </div>
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.archivo">
                                                        <app-file-uploader-extranet  
                                                            [fileInfo]="false"  
                                                            [id]="fila.respuestas[col.idx]" 
                                                            [(Files)]="_imagen_archivo" 
                                                            [(Uploading)]="estaGuardando"
                                                            [pesoMaximoEnMB]="pesoMaximoEnMB" 
                                                            [esBorrador]="false" 
                                                            (FileChange)="set_archivo_fila_matriz($event,fila.idx,col.idx)"
                                                            (onRemovedIdFile)="handleRemovedFilePresentacionMatriz($event,fila.idx,col.idx)"
                                                            [extensionAceptados]="imagen_extensionAceptados"   
                                                            [tiposMimePermitidos]="imagen_MimePermitidos" 
                                                            [view_width]="600"
                                                            [puedeVerArchivo]="true"
                                                            [puedeEliminarArchivo]="true"
                                                            [puedeDescargarArchivo] = "true"
                                                            [url]="url" 
                                                            [loading]="estaGuardando">
                                                        </app-file-uploader-extranet>  
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </nz-table>
                                </div>
                                <div class="table-responsive table-striped table-bordered table-hover" *ngIf="!JSON_PREGUNTA.es_columna_matriz">
                                    <nz-table #basicTable 
                                    [nzData]="JSON_PREGUNTA.respuesta"
                                    [nzFrontPagination]="false"
                                    [nzShowPagination]="false"
                                    [nzLoading]="loading_matriz"
                                    class="container-table-custom">
                                        <thead>
                                            <tr>
                                                <th class="th-columna"></th>
                                                <th class="th-columna" style="width:170px"  *ngFor="let col of JSON_PREGUNTA.columnas" align="center">{{col.nombre_columna}}</th>
                                            </tr>
                                        </thead>
                                        <tbody >
                                            <tr *ngFor="let fila of basicTable.data" align="center">
                                                <td class="td-fila" style="min-width:250px" align="center">{{fila.nombre_fila}}</td>
                                                <td align="center" *ngFor="let col of fila.columnas;">
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.numerico_entero">
                                                        <nz-form-item style="width:100%">
                                                            <nz-form-control nzErrorTip="Debe seleccionar un número!" style="width:100%">
                                                                <nz-input-group style="width:100%">
                                                                    <input 
                                                                    type="text" 
                                                                    style="width:170px"
                                                                    [formControl]="frmMtz[fila.idx][col.idx]"
                                                                    [(ngModel)]="fila.respuestas[col.idx]" 
                                                                    (ngModelChange)	="setRespuestaMatriz(fila.idx,col.idx)"
                                                                    (keypress)="conteoDigitosEnteroMatriz($event,fila.idx,col.idx)"
                                                                    >
                                                                    <!-- <nz-input-number  style="width:95%"
                                                                        [formControl]="frmMtz[fila.idx][col.idx]"
                                                                        [(ngModel)]="fila.respuestas[col.idx]" 
                                                                        (ngModelChange)	="setRespuestaMatriz(fila.idx,col.idx)"
                                                                        [nzMin]="1" 
                                                                        [nzMax]="9999">
                                                                    </nz-input-number> -->
                                                                </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>
                                                    </div>
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.numerico_decimal">
                                                        <nz-form-item style="width: 95%">
                                                            <nz-form-control nzErrorTip="Debe seleccionar un número!"style="width:100%">
                                                                <nz-input-group style="width:100%">
                                                                    <input 
                                                                    type="text" 
                                                                    style="width:170px"
                                                                    [formControl]="frmMtz[fila.idx][col.idx]"
                                                                    [(ngModel)]="fila.respuestas[col.idx]" 
                                                                    (ngModelChange)="setRespuestaMatriz(fila.idx,col.idx)"
                                                                    (keypress)="conteoDigitosDecimalMatriz($event,fila.idx,col.idx)"
                                                                    >
                                                                    <!-- <nz-input-number  style="width:95%"
                                                                        [formControl]="frmMtz[fila.idx][col.idx]"
                                                                        [(ngModel)]="fila.respuestas[col.idx]" 
                                                                        (ngModelChange)="setRespuestaMatriz(fila.idx,col.idx)"
                                                                        [nzMin]="1" 
                                                                        [nzMax]="9999" 
                                                                        [nzStep]="setNroDecimales(col.forma.nro_decimal)">
                                                                    </nz-input-number> -->
                                                                </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>
                                                    </div>
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.seleccion_unica">
                                                        <nz-form-item>
                                                            <nz-form-control nzErrorTip="Debe seleccionar una alternativa!" style="width:100%">
                                                                <nz-input-group>
                                                                    <nz-select nzAllowClear nzShowSearch
                                                                    (ngModelChange)	="setRespuestaMatriz(fila.idx,col.idx,true)"
                                                                    [formControl]="frmMtz[fila.idx][col.idx]"
                                                                    [(ngModel)]="fila.respuestas[col.idx]" 
                                                                    style="max-width: 100% !important; min-width: 170px !important;"
                                                                    nzPlaceHolder="--Seleccione--">
                                                                        <ng-container *ngFor="let _item of col.forma.opciones">
                                                                            <nz-option [nzValue]="_item.descripcion" [nzLabel]="_item.descripcion"></nz-option>
                                                                        </ng-container>
                                                                    </nz-select>
                                                                </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>
                                                    </div>
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.seleccion_multiple ||
                                                    col.forma.id_tipo==_TIPO_PREGUNTA.desplegable_libre">
                                                        <nz-form-item>
                                                            <nz-form-control nzErrorTip="Debe seleccionar una alternativa!" style="width:100%">
                                                                <nz-input-group>
                                                                    <nz-select nzAllowClear nzShowSearch 
                                                                    [formControl]="frmMtz[fila.idx][col.idx]"
                                                                    [(ngModel)]="fila.respuestas[col.idx]" 
                                                                    (ngModelChange)	="setRespuestaMatriz(fila.idx,col.idx)"
                                                                    style="max-width: 100% !important; min-width: 170px !important;"
                                                                    nzMode="multiple"
                                                                    nzPlaceHolder="--Seleccione--">
                                                                        <ng-container *ngFor="let _item of col.forma.opciones">
                                                                            <nz-option [nzValue]="_item.descripcion" [nzLabel]="_item.descripcion"></nz-option>
                                                                        </ng-container>
                                                                    </nz-select>
                                                                </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>
                                                    </div>
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.desplegable_institucional && col.forma.tbl_data==2" class="row">
                                                        <nz-form-item>
                                                            <nz-form-control nzErrorTip="Debe seleccionar una alternativa!" style="width:100%">
                                                                <nz-input-group>
                                                                    <nz-select nzAllowClear nzShowSearch 
                                                                    [formControl]="frmMtz[fila.idx][col.idx]"
                                                                    [(ngModel)]="fila.respuestas[col.idx]" 
                                                                    (ngModelChange)	="setRespuestaMatriz(fila.idx,col.idx)"
                                                                    style="max-width: 100% !important; min-width: 170px !important;"
                                                                    nzPlaceHolder="--Seleccione--">
                                                                        <ng-container *ngFor="let item of array_regimen_cbo">
                                                                            <nz-option [nzValue]="item.id" [nzLabel]="item.nombre"></nz-option>
                                                                        </ng-container>
                                                                    </nz-select>
                                                                </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>
                                                    </div>    
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.desplegable_institucional && col.forma.tbl_data==1" class="row">
                                                        <nz-form-item>
                                                            <nz-form-control nzErrorTip="Debe seleccionar una alternativa!" style="width:100%">
                                                                <nz-input-group>
                                                                    <nz-select nzAllowClear nzShowSearch 
                                                                    [formControl]="frmMtz[fila.idx][col.idx]"
                                                                    [(ngModel)]="fila.respuestas[col.idx]" 
                                                                    (ngModelChange)	="setRespuestaMatriz(fila.idx,col.idx)"
                                                                    style="max-width: 100% !important; min-width: 170px !important;"
                                                                    nzPlaceHolder="--Seleccione--">
                                                                        <ng-container *ngFor="let item of array_d_gen">
                                                                            <nz-option [nzValue]="item.id" [nzLabel]="item.nombre"></nz-option>
                                                                        </ng-container>
                                                                    </nz-select>
                                                                </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>
                                                    </div>
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.fecha">
                                                        <nz-form-item style="width:100%">
                                                            <nz-form-control nzErrorTip="Debe seleccionar una fecha!" style="width:100%">
                                                                <nz-input-group style="width:100%">
                                                                    <nz-date-picker 
                                                                    style="max-width: 100%!important;"
                                                                        [(ngModel)]="fila.respuestas[col.idx]" 
                                                                        nzFormat="{{ col.forma.formato }}"
                                                                        nzPlaceHolder="{{ col.forma.formato }}">
                                                                        </nz-date-picker>
                                                                    </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>
                                                    </div>
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.texto">
                                                        <nz-form-item>
                                                            <nz-form-control nzErrorTip="Debe ingresar un texto." style="width:100%">
                                                                <nz-input-group>
                                                                    <textarea nz-input class="form-control" 
                                                                    style="width:190px"
                                                                    maxlength="100"
                                                                    [(ngModel)]="fila.respuestas[col.idx]"  placeholder="Ingresar"></textarea>
                                                                </nz-input-group>
                                                            </nz-form-control>
                                                        </nz-form-item>   
                                                    </div>
                                                    <div *ngIf="col.forma.id_tipo==_TIPO_PREGUNTA.archivo">
                                                        <app-file-uploader-extranet  
                                                            [fileInfo]="false"  
                                                            [id]="fila.respuestas[col.idx]" 
                                                            [(Files)]="_imagen_archivo" 
                                                            [(Uploading)]="estaGuardando"
                                                            [pesoMaximoEnMB]="pesoMaximoEnMB" 
                                                            [esBorrador]="false" 
                                                            (FileChange)="set_archivo_fila_matriz($event,fila.idx,col.idx)"
                                                            (onRemovedIdFile)="handleRemovedFilePresentacionMatriz($event,fila.idx,col.idx)"
                                                            [extensionAceptados]="imagen_extensionAceptados"   
                                                            [tiposMimePermitidos]="imagen_MimePermitidos" 
                                                            [view_width]="600"
                                                            [puedeVerArchivo]="true"
                                                            [puedeEliminarArchivo]="true"
                                                            [puedeDescargarArchivo] = "true"
                                                            [url]="url" 
                                                            [loading]="estaGuardando">
                                                        </app-file-uploader-extranet>  
                                                    </div>
                                                </td>                                                
                                            </tr>             
                                        </tbody>
                                    </nz-table>
                                </div>
                            </div> 
                            <div class="col-md-12" style="padding-top: 25px;padding-left: 0;" *ngIf="JSON_PREGUNTA.id_tipo==_TIPO_PREGUNTA.fecha">
                                <div class="row">
                                    <div class="col-md-5 col-sm-6">
                                        <div style="background-color:#EAEFF5; height: 40px;">
                                            <label style="padding-top:9px">
                                                &nbsp;&nbsp;<strong>Selecciona fecha</strong>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-7 col-sm-6">
                                        <div class="form-group">
                                            <nz-date-picker 
                                            [(ngModel)]="JSON_PREGUNTA.respuesta" 
                                            nzFormat="{{formato_fecha}}"
                                            nzPlaceHolder="{{formato_fecha}}">
                                            </nz-date-picker>
                                        </div>
                                    </div>
                                </div>
                            </div> 
                            <div class="col-md-12" style="padding-top: 25px;padding-left: 0;" *ngIf="JSON_PREGUNTA.id_tipo==_TIPO_PREGUNTA.texto" >
                                <div class="form-group">
                                    <nz-form-item>
                                        <nz-form-control nzErrorTip="Debe ingresar un texto.">
                                            <nz-input-group>
                                                <textarea nz-input class="form-control" 
                                                maxlength="{{cantidad_caracteres}}"
                                                [(ngModel)]="JSON_PREGUNTA.respuesta"  placeholder="Ingresar"></textarea>
                                            </nz-input-group>
                                        </nz-form-control>
                                    </nz-form-item>   
                                </div>
                                <span class="text-caracteres">Caracteres max {{cantidad_caracteres}}</span>
                            </div> 
                            <div class="col-md-12 " style="padding-top: 25px;padding-left: 0;" *ngIf="JSON_PREGUNTA.id_tipo==_TIPO_PREGUNTA.mensaje" >
                                <div class="text-mensaje" [innerHTML]="JSON_PREGUNTA.mensaje"></div>
                            </div> 
                            <div class="col-md-12" style="padding-top: 25px;padding-left: 0;" *ngIf="JSON_PREGUNTA.id_tipo==_TIPO_PREGUNTA.archivo">
                                <div class="row">
                                    <div class="col-md-8 col-sm-12">
                                        <app-file-uploader-extranet  
                                            [fileInfo]="true"  
                                            [id]="JSON_PREGUNTA.respuesta" 
                                            [(Files)]="_imagen_archivo" 
                                            [(Uploading)]="estaGuardando"
                                            [pesoMaximoEnMB]="pesoMaximoEnMB" 
                                            [esBorrador]="false" 
                                            (FileChange)="set_imagen_iden($event)"
                                            (onRemovedIdFile)="handleRemovedFilePresentacion($event)"
                                            [extensionAceptados]="_imagen_extensionAceptados"   
                                            [tiposMimePermitidos]="_imagen_MimePermitidos" 
                                            [nombreSeleccion] = "_placeholder"
                                            [view_width]="600"
                                            [puedeVerArchivo]="true"
                                            [puedeEliminarArchivo]="true"
                                            [puedeDescargarArchivo] = "true"
                                            [url]="url" 
                                            [loading]="estaGuardando">
                                        </app-file-uploader-extranet>
                                    </div> 
                                    <div class="col-md-8 col-sm-12" style="padding-top: 30px;">
                                        <p class="text-archivo">Para subir un archivo sigue estos pasos</p>
                                    </div>  
                                    <div class="col-md-12 col-sm-12" style="padding-top: 12px;">
                                        <span class="text-archivo">1. Da click en el icono <img src="assets/img/adjuntar.png"> para adjuntar un archivo desde tu dispositivo</span><br>
                                        <span class="text-archivo">2. Da click en el icono <img src="assets/img/subir.png"> para cargarlo y guardarlo</span>
                                    </div>                                 
                                </div>
                            </div> 
                        </div>    

                        <div [ngClass]="tieneArchivo ? 'col-md-5': 'col-md-12'" style="padding-top: 50px;"  align="center">
                           <div *ngIf="_loaded_media_pregunta && _idYoutubeVideo_pregunta && Pregunta && Pregunta.id_tipo_archivo==_TIPO_ARCHIVO.video">
                            <youtube-player
                                [videoId]="_idYoutubeVideo_pregunta"
                                (ready)="_savePlayer_pregunta($event)"
                                [width]="'100%'"
                                [height]="300"
                                (change)="_onStateChange_pregunta($event)">
                            </youtube-player>
                           </div>
                           <div  style="width: 100%;" *ngIf="_loaded_media_pregunta && Pregunta && Pregunta.id_tipo_archivo==_TIPO_ARCHIVO.imagen">
                            <img [src]="_urlArchivo_pregunta" width="400px" height="415px">
                            </div>
                            <div  style="width: 100%;" *ngIf="_loaded_media_pregunta==false && Pregunta && Pregunta.id_tipo_archivo==_TIPO_ARCHIVO.imagen">
                                <img src="../../../../../../../assets/images/Imagen_no_disponible.png" width="400px" height="415px">
                            </div> 
                        </div>                        
                    </div>        
                </div>
                <div class="row" style="padding-top: 80px">
                    <div class="col-sm-6 text-left">
                        <button style="font-size: 16px !important;" type="button" class="btn btn-atras" (click)="onPageChangePrev()" *ngIf="pageIndex>1" >
                            <i class="fa fa-arrow-left"></i>&nbsp;&nbsp;&nbsp;&nbsp;Volver
                        </button>
                        <button style="font-size: 16px !important;" type="button" class="btn btn-atras" (click)="GoBackEncuesta()" *ngIf="pageIndex==1">
                            <i class="fa fa-arrow-left"></i>&nbsp;&nbsp;&nbsp;&nbsp;Atrás
                        </button>
                    </div>
                    <div class="col-sm-6 text-right">
                        <button type="button" class="btn btn-finalizar" (click)="goFinalizarEncuesta()" *ngIf="pageIndex>=total" style="margin-right: 0px; font-size: 16px !important;">
                            Finalizar&nbsp;&nbsp;&nbsp;&nbsp;<i class="fa fa-arrow-right"></i></button>
                        <button type="button" class="btn btn-siguiente" (click)="onPageChangeNext()" *ngIf="total>pageIndex && !esPreguntaUltima"  style="margin-right: 0px; font-size: 16px !important;">
                            Siguiente&nbsp;&nbsp;&nbsp;&nbsp;<i class="fa fa-arrow-right"></i></button>
                        <button type="button" class="btn btn-finalizar" (click)="onPageChangeNext()" *ngIf="total>pageIndex && esPreguntaUltima"  style="margin-right: 0px; font-size: 16px !important;">
                            Ir a la sección {{numeroSeccion}}&nbsp;&nbsp;&nbsp;&nbsp;<i class="fa fa-arrow-right"></i></button>
                        
                    </div>
                </div>
            </div>
            <div class="col-sm-1"></div>
        </div>
    </div>
</ng-container>
<ng-container *ngIf="show_final_envio">
    <div class="_container">
        <div class="row">
            <div class="col-sm-1"></div>
            <div class="col-sm-10 row">
                <div class="col-sm-12" align="center" style="padding-top: 100px;">
                    <br><h1 class="text-gracias">Muchas gracias por participar en el Censo de Startups peruanas 2023&nbsp;&nbsp;&nbsp;&nbsp;
                        <img src="assets/img/audio.png"></h1>
                </div>
                <div class="col-sm-12" align="center">
                    <br><br>
                    <p class="text-mensaje">Tu encuesta ha sido completada satisfactoriamente el {{fecha_envio | date:'dd/MM/yyyy'}} a las {{fecha_envio | date:'hh:mm:ss a'}}</p>
                </div>
                <div class="col-sm-12" align="center" style="padding-top: 30px;">
                    <br>
                        <button (click)="goBackToInicio()" type="button" style="background-color: #128C3C;color: #ffffff;font-size: 16px !important;" 
                        class="btn btn-continuar">Finalizar</button>
                </div>
            </div>
            <div class="col-sm-1"></div>
            <div class="col-md-12" style="padding-left: 0px;padding-right: 0px; margin-top: 250px;">
                <div class="col-md-4" style="padding: 0px; text-align-last: left;">
                    <img src="../../../../../../../assets/images/logo-produce2.png" width="65%">
                </div>
                <div class="col-md-4" style="padding: 0px; text-align-last: center;">
                    <img src="../../../../../../../assets/images/logo-proinnovate.png" width="60%">
                </div>
                <div class="col-md-4" style="padding: 0px; text-align-last: right;">
                    <img src="../../../../../../../assets/images/logo-pecap.png" width="60%">
                </div>
            </div>
        </div>
    </div>
</ng-container>

<ng-container *ngIf="show_pantalla_agradecimiento">
    <div class="_container">
        <div class="row">
            <div class="col-sm-12">
                <br><h1 style="color:#dc3545">{{title?title:''}}</h1>
            </div>
            <div class="col-sm-1"></div>
            <div class="col-sm-10 row">
                <div class="col-sm-11">
                    <h3 style="color:#dc3545">{{agradecimiento_data?agradecimiento_data.mensaje_agradecimiento:''}}</h3>
                </div>
                <div class="col-sm-1" align="right"></div>
                
                <div class="col-sm-12" align="center">
                    <br>
                    <div  *ngIf="_loaded_media_agradecimiento && _idYoutubeVideo_agradecimiento 
                    && agradecimiento_data 
                    && agradecimiento_data.id_tipo_archivo==_TIPO_ARCHIVO.video" align="center">
                        <youtube-player
                            [videoId]="_idYoutubeVideo_agradecimiento"
                            (ready)="_savePlayer_agradecimiento($event)"
                            [width]="'100%'"
                            [height]="400"
                            (change)="_onStateChange_agradecimiento($event)">
                        </youtube-player>
                    </div>
                    <div  style="width: 100%;" *ngIf="_loaded_media_agradecimiento && agradecimiento_data && agradecimiento_data.id_tipo_archivo==_TIPO_ARCHIVO.imagen">
                        <img [src]="_urlArchivo_agradecimiento" width="400px" height="415px">
                    </div>
                    <div  style="width: 100%;" *ngIf="_loaded_media_agradecimiento==false && agradecimiento_data && agradecimiento_data.id_tipo_archivo==_TIPO_ARCHIVO.imagen">
                        <img src="../../../../../../../assets/images/Imagen_no_disponible.png" width="400px" height="415px">
                    </div> 
                </div>
                <div class="col-sm-12" align="center">
                    <br>
                    <button type="button" class="btn btn-primary-custom" (click)="goBackToInicio()" style="font-size:15px;font-size: 16px !important;">
                        Volver al inicio <i class="fa fa-share"></i>
                    </button>
                </div>
            </div>
            <div class="col-sm-1"></div>
        </div>
    </div>
</ng-container>
